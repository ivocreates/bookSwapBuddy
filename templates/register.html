{% extends "base.html" %}

{% block title %}Register - BookSwapBuddy{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
            <div class="card shadow-lg border-0">
                <div class="card-header text-center py-4">
                    <h2 class="mb-0">
                        <i class="fas fa-user-plus text-primary me-2"></i>
                        Join BookSwapBuddy
                    </h2>
                    <p class="text-muted mt-2">Create your free account and start exchanging books today!</p>
                </div>
                
                <div class="card-body p-5">
                    <form method="POST" class="needs-validation" novalidate>
                        <div class="row">
                            <!-- Personal Information -->
                            <div class="col-md-6">
                                <h5 class="text-primary mb-3">
                                    <i class="fas fa-user me-2"></i>Personal Information
                                </h5>
                                
                                <div class="mb-3">
                                    <label for="full_name" class="form-label">
                                        <i class="fas fa-id-card me-2"></i>Full Name *
                                    </label>
                                    <input type="text" class="form-control" 
                                           id="full_name" name="full_name" required
                                           placeholder="Enter your full name">
                                    <div class="invalid-feedback">
                                        Please enter your full name.
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="username" class="form-label">
                                        <i class="fas fa-at me-2"></i>Username *
                                    </label>
                                    <input type="text" class="form-control" 
                                           id="username" name="username" required
                                           placeholder="Choose a unique username"
                                           pattern="^[a-zA-Z0-9_]{3,20}$">
                                    <div class="form-text">
                                        3-20 characters, letters, numbers and underscore only
                                    </div>
                                    <div class="invalid-feedback">
                                        Username must be 3-20 characters with letters, numbers, and underscore only.
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="email" class="form-label">
                                        <i class="fas fa-envelope me-2"></i>Email Address *
                                    </label>
                                    <input type="email" class="form-control" 
                                           id="email" name="email" required
                                           placeholder="your.email@university.edu">
                                    <div class="form-text">
                                        We recommend using your university email
                                    </div>
                                    <div class="invalid-feedback">
                                        Please enter a valid email address.
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="phone" class="form-label">
                                        <i class="fas fa-phone me-2"></i>Phone Number
                                    </label>
                                    <input type="tel" class="form-control" 
                                           id="phone" name="phone"
                                           placeholder="+91-XXXXX-XXXXX"
                                           pattern="^[\+]?[0-9\-\s\(\)]{10,15}$">
                                    <div class="form-text">
                                        Optional - for direct contact during exchanges
                                    </div>
                                    <div class="invalid-feedback">
                                        Please enter a valid phone number.
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Academic Information -->
                            <div class="col-md-6">
                                <h5 class="text-primary mb-3">
                                    <i class="fas fa-graduation-cap me-2"></i>Academic Information
                                </h5>
                                
                                <div class="mb-3">
                                    <label for="college" class="form-label">
                                        <i class="fas fa-university me-2"></i>College/University *
                                    </label>
                                    <input type="text" class="form-control" 
                                           id="college" name="college" required
                                           placeholder="Indian Institute of Technology Delhi"
                                           list="colleges">
                                    <datalist id="colleges">
                                        <option value="Indian Institute of Technology Delhi">
                                        <option value="Indian Institute of Technology Bombay">
                                        <option value="Indian Institute of Technology Madras">
                                        <option value="Indian Institute of Technology Kanpur">
                                        <option value="Indian Institute of Technology Kharagpur">
                                        <option value="National Institute of Technology Delhi">
                                        <option value="Delhi University">
                                        <option value="Jawaharlal Nehru University">
                                        <option value="Jamia Millia Islamia">
                                        <option value="Anna University">
                                    </datalist>
                                    <div class="invalid-feedback">
                                        Please enter your college name.
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="department" class="form-label">
                                        <i class="fas fa-cogs me-2"></i>Department *
                                    </label>
                                    <select class="form-select" id="department" name="department" required>
                                        <option value="">Select your department</option>
                                        <option value="Computer Science Engineering">Computer Science Engineering</option>
                                        <option value="Electronics and Communication">Electronics and Communication</option>
                                        <option value="Mechanical Engineering">Mechanical Engineering</option>
                                        <option value="Civil Engineering">Civil Engineering</option>
                                        <option value="Electrical Engineering">Electrical Engineering</option>
                                        <option value="Chemical Engineering">Chemical Engineering</option>
                                        <option value="Aerospace Engineering">Aerospace Engineering</option>
                                        <option value="Biotechnology">Biotechnology</option>
                                        <option value="Information Technology">Information Technology</option>
                                        <option value="Mathematics">Mathematics</option>
                                        <option value="Physics">Physics</option>
                                        <option value="Chemistry">Chemistry</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select your department.
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="year" class="form-label">
                                        <i class="fas fa-calendar-alt me-2"></i>Current Year *
                                    </label>
                                    <select class="form-select" id="year" name="year" required>
                                        <option value="">Select your current year</option>
                                        <option value="1">1st Year</option>
                                        <option value="2">2nd Year</option>
                                        <option value="3">3rd Year</option>
                                        <option value="4">4th Year</option>
                                        <option value="5">5th Year (M.Tech/Integrated)</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select your current year.
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="hostel" class="form-label">
                                        <i class="fas fa-home me-2"></i>Hostel/Residence
                                    </label>
                                    <input type="text" class="form-control" 
                                           id="hostel" name="hostel"
                                           placeholder="Hostel name or area (Optional)">
                                    <div class="form-text">
                                        Helps in finding nearby book exchanges
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Password Section -->
                        <hr class="my-4">
                        <h5 class="text-primary mb-3">
                            <i class="fas fa-key me-2"></i>Account Security
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="password" class="form-label">
                                        <i class="fas fa-lock me-2"></i>Password *
                                    </label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" 
                                               id="password" name="password" required
                                               placeholder="Create a strong password"
                                               minlength="8">
                                        <button class="btn btn-outline-secondary" type="button" 
                                                onclick="togglePassword('password')"
                                                title="Show/Hide Password">
                                            <i class="fas fa-eye" id="password-toggle-icon"></i>
                                        </button>
                                    </div>
                                    <div class="form-text">
                                        Minimum 8 characters with letters, numbers, and symbols
                                    </div>
                                    <div class="invalid-feedback">
                                        Password must be at least 8 characters long.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="confirm_password" class="form-label">
                                        <i class="fas fa-lock me-2"></i>Confirm Password *
                                    </label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" 
                                               id="confirm_password" name="confirm_password" required
                                               placeholder="Re-enter your password">
                                        <button class="btn btn-outline-secondary" type="button" 
                                                onclick="togglePassword('confirm_password')"
                                                title="Show/Hide Password">
                                            <i class="fas fa-eye" id="confirm_password-toggle-icon"></i>
                                        </button>
                                    </div>
                                    <div class="invalid-feedback">
                                        Passwords do not match.
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Terms and Conditions -->
                        <div class="mb-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" 
                                       id="terms" name="terms" required>
                                <label class="form-check-label" for="terms">
                                    I agree to the 
                                    <a href="#" class="text-primary">Terms of Service</a> 
                                    and 
                                    <a href="#" class="text-primary">Privacy Policy</a> *
                                </label>
                                <div class="invalid-feedback">
                                    You must agree to the terms and conditions.
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" 
                                       id="newsletter" name="newsletter">
                                <label class="form-check-label" for="newsletter">
                                    Send me updates about new features and book recommendations
                                </label>
                            </div>
                        </div>
                        
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-user-plus me-2"></i>Create My Account
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="card-footer text-center py-4 bg-light">
                    <p class="mb-0">
                        Already have an account? 
                        <a href="{{ url_for('login') }}" class="text-primary fw-bold">
                            Sign in here
                        </a>
                    </p>
                </div>
            </div>
            
            <!-- Benefits -->
            <div class="row mt-5">
                <div class="col-md-4 text-center">
                    <div class="mb-3">
                        <i class="fas fa-money-bill-wave fa-2x text-success"></i>
                    </div>
                    <h6>Save Money</h6>
                    <p class="text-muted small">
                        Buy used books at lower prices or exchange books you no longer need.
                    </p>
                </div>
                
                <div class="col-md-4 text-center">
                    <div class="mb-3">
                        <i class="fas fa-recycle fa-2x text-primary"></i>
                    </div>
                    <h6>Go Green</h6>
                    <p class="text-muted small">
                        Reduce waste by giving books a second life through exchanges.
                    </p>
                </div>
                
                <div class="col-md-4 text-center">
                    <div class="mb-3">
                        <i class="fas fa-users fa-2x text-info"></i>
                    </div>
                    <h6>Build Network</h6>
                    <p class="text-muted small">
                        Connect with students from your college and across India.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function togglePassword(inputId) {
    const input = document.getElementById(inputId);
    const icon = document.getElementById(inputId + '-toggle-icon');
    
    if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
    } else {
        input.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
    }
}

// Real-time password validation
document.addEventListener('DOMContentLoaded', function() {
    const passwordField = document.getElementById('password');
    const confirmPasswordField = document.getElementById('confirm_password');
    
    // Check password match
    function checkPasswordMatch() {
        if (passwordField.value !== confirmPasswordField.value) {
            confirmPasswordField.setCustomValidity('Passwords do not match');
        } else {
            confirmPasswordField.setCustomValidity('');
        }
    }
    
    confirmPasswordField.addEventListener('input', checkPasswordMatch);
    passwordField.addEventListener('input', checkPasswordMatch);
    
    // Username availability check (simulation)
    const usernameField = document.getElementById('username');
    let usernameTimeout;
    
    usernameField.addEventListener('input', function() {
        clearTimeout(usernameTimeout);
        const username = this.value.trim();
        
        if (username.length >= 3) {
            usernameTimeout = setTimeout(() => {
                // Simulate username check
                if (username === 'admin' || username === 'test') {
                    this.setCustomValidity('Username already taken');
                    this.classList.add('is-invalid');
                } else {
                    this.setCustomValidity('');
                    this.classList.remove('is-invalid');
                    this.classList.add('is-valid');
                }
            }, 500);
        }
    });
    
    // Auto-focus full name field
    document.getElementById('full_name').focus();
});
</script>
{% endblock %}
